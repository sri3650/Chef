# Add Monit code for Sphinx's searchd
check process searchd with pidfile /mnt/app/shared/log/searchd.<%= node.chef_environment %>.pid
  start program = "/usr/local/chronus/bin/searchd_start"
  stop program = "/usr/local/chronus/bin/searchd_stop"
  if totalmem is greater than 300.0 MB for 4 cycles then restart
  if cpu is greater than 80% for 4 cycles then restart
  if failed port 9312 with timeout 10 seconds then restart
  if 20 restarts within 20 cycles then timeout
  mode manual
  group searchd